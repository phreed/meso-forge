# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json
schema_version: 1

context:
  version: "${{ GEM_VERSION }}"

package:
  name: ruby-${{ GEM_NAME }}
  version: ${{ version }}

source:
  url: https://rubygems.org/downloads/${{ GEM_NAME }}-${{ version }}.gem
  sha256: ${{ SHA256_HASH }}

build:
  number: 0
  script:
    - gem install $SRC_DIR/*.gem --install-dir $PREFIX/lib/ruby/gems/$RUBY_VERSION --no-document

requirements:
  build:
    # Remove compilers if gem is pure Ruby
    - ${{ compiler('c') }} # [not win]
    - ${{ compiler('cxx') }} # [not win]
    - ${{ compiler('m2w64_c') }} # [win]
    - ${{ compiler('m2w64_cxx') }} # [win]
  host:
    - ruby
    # Add Ruby gem dependencies here
    # - ruby-activesupport
    # - ruby-nokogiri
    # - ruby-rake  # [if build dependency]
  run:
    - ruby
    # Copy runtime dependencies from host section
    # - ruby-activesupport
    # - ruby-nokogiri

tests:
  - script:
      - ruby -e "require '${{ GEM_NAME }}'"

about:
  homepage: ${{ HOMEPAGE_URL }}
  repository: ${{ DEV_URL }}
  documentation: https://rubydoc.info/gems/${{ GEM_NAME }}
  license: ${{ LICENSE }}
  license_file: LICENSE
  summary: ${{ GEM_SUMMARY }}
  description: |
    ${{ GEM_DESCRIPTION }}

extra:
  recipe-maintainers:
    - ${{ MAINTAINER_GITHUB_USERNAME }}
  additional-platforms:
    - linux-aarch64
    - osx-arm64
