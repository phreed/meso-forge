# yaml-language-server: $schema=https://raw.githubusercontent.com/prefix-dev/recipe-format/main/schema.json
schema_version: 1

context:
  version: 5.2.0

package:
  name: asciidoctor-revealjs
  version: ${{ version }}

source:
- url: https://rubygems.org/downloads/asciidoctor-revealjs-${{ version }}.gem
  sha256: 3504a5e7eaf2c91de37f96189314ffb1e6bf94dad9d646d5c9a24c6691bf6ae2

build:
  number: 0
  noarch: generic
  script:
  - gem install -N -l -V --norc --ignore-dependencies -n $PREFIX/bin asciidoctor-revealjs-${{ version }}.gem
  - gem unpack asciidoctor-revealjs-${{ version }}.gem
  - cp asciidoctor-revealjs-${{ version }}/LICENSE.adoc LICENSE.adoc

requirements:
  host:
  - ruby
  run:
  - ${{ pin_compatible('ruby', upper_bound='x.x') }}
  - asciidoctor >=1.5.0

tests:
  # Test 1: Verify package contents are included
- package_contents:
    files:
        # Asciidoctor Reveal.js binary
    - ${{ "Library/" if win }}bin/asciidoctor-revealjs${{ ".exe" if win }}

  # Test 2: Ruby import test
- requirements:
    build:
    - ruby
  script:
    interpreter: ruby
    content: |
      require 'asciidoctor-revealjs'

  # Test 3: Functional test
- requirements:
    build:
    - nushell
  script:
    interpreter: nu
    content:
    - ^asciidoctor-revealjs --version

about:
  homepage: https://github.com/asciidoctor/asciidoctor-reveal.js
  license: MIT
  license_file: LICENSE.adoc
  summary: A reveal.js converter for Asciidoctor and Asciidoctor.js. Write your slides in AsciiDoc!
  description: |
    Asciidoctor reveal.js is a converter for Asciidoctor and Asciidoctor.js
    that transforms an AsciiDoc document into an HTML5 presentation
    designed to be executed by the reveal.js presentation framework.
  repository: https://github.com/asciidoctor/asciidoctor-reveal.js

extra:
  recipe-maintainers:
  - phreed
  version:
    rubygems:
    - ^(\d+\.\d+\.\d+)
